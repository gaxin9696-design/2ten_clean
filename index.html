<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>UI Skeleton (No banner/poster motion)</title>
  <style>
    :root{
      --bg0:#0a0b10;
      --bg1:#0f1320;
      --panel: rgba(255,255,255,.06);
      --panel2: rgba(255,255,255,.04);
      --stroke: rgba(255,255,255,.10);
      --stroke2: rgba(255,255,255,.16);
      --text:#e9edf6;
      --muted:#a6b0c3;
      --muted2:#7f8aa6;
      --accent:#f1c55a;
      --accent2:#60a5fa;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --shadow2: 0 10px 30px rgba(0,0,0,.35);
      --r12:12px; --r16:16px; --r20:20px; --r24:24px;
      --max: 1180px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(900px 520px at 20% 8%, rgba(96,165,250,.18), transparent 58%),
        radial-gradient(900px 520px at 78% 12%, rgba(241,197,90,.12), transparent 58%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
    }
    a{color:inherit;text-decoration:none}
    .wrap{max-width:var(--max);margin:0 auto;padding:18px}
    @media (max-width:540px){ .wrap{padding:14px} }

    /* TOPBAR */
    .topbar{
      position:sticky; top:0; z-index:50;
      background: linear-gradient(180deg, rgba(10,11,16,.92), rgba(10,11,16,.75));
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .topbar-inner{
      max-width:var(--max);
      margin:0 auto;
      padding:12px 18px;
      display:flex; align-items:center; gap:14px;
    }
    .brand{display:flex; align-items:center; gap:10px; min-width: 160px;}
    .logo{
      width:40px;height:40px;border-radius:14px;
      background:
        radial-gradient(circle at 30% 25%, rgba(241,197,90,.9), rgba(96,165,250,.35)),
        rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: var(--shadow2);
    }
    .brand .t1{font-weight:950; letter-spacing:.2px; line-height:1}
    .brand .t2{font-size:11px; color:var(--muted2); margin-top:2px}

    .search{
      flex: 1 1 auto;
      display:flex; align-items:center; gap:10px;
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      min-width: 240px;
    }
    .search input{
      width:100%;
      border:none; outline:none;
      background:transparent;
      color:var(--text);
      font-size:14px;
    }
    .search:focus-within{
      border-color: rgba(241,197,90,.45);
      box-shadow: 0 0 0 4px rgba(241,197,90,.12);
    }

    .menu{display:flex; align-items:center; gap:6px; flex: 0 0 auto;}
    .mitem{
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid transparent;
      color: rgba(233,237,246,.92);
      font-weight:800;
      font-size:13px;
      opacity:.92;
      cursor:pointer;
      white-space:nowrap;
      user-select:none;
    }
    .mitem:hover{border-color: rgba(255,255,255,.10); background: rgba(255,255,255,.03); opacity:1;}
    .mitem.active{
      border-color: rgba(241,197,90,.35);
      background: rgba(241,197,90,.10);
    }

    .member{
      margin-left:6px;
      display:inline-flex; align-items:center; gap:8px;
      padding:10px 12px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      font-weight:900;
      cursor:pointer;
      white-space:nowrap;
      user-select:none;
    }
    .member .dot{width:10px;height:10px;border-radius:999px;background: rgba(241,197,90,.9);box-shadow: 0 0 0 3px rgba(241,197,90,.14);}

    @media (max-width: 980px){
      .menu{display:none}
      .brand{min-width:auto}
    }

    /* Dropdown */
    .dropdown{position:relative; display:inline-block;}
    .dd-panel{
      position:absolute;
      top:44px; left:0;
      width: 220px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,11,16,.92);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow2);
      padding:8px;
      display:none;
    }
    .dd-panel.open{display:block;}
    .dd-item{
      padding:10px 10px;
      border-radius: 12px;
      cursor:pointer;
      font-weight:800;
      color: rgba(233,237,246,.92);
      display:flex; align-items:center; justify-content:space-between;
      border:1px solid transparent;
      user-select:none;
    }
    .dd-item:hover{background: rgba(255,255,255,.05); border-color: rgba(255,255,255,.08);}
    .dd-item small{color:var(--muted2); font-weight:900}

    /* TITLE */
    .section-title{
      display:flex; align-items:center; gap:10px;
      margin:18px 0 12px;
      font-weight:950;
      letter-spacing:.2px;
      font-size:26px;
    }
    .section-title .pill{
      margin-left:6px;
      display:inline-flex; align-items:center; justify-content:center;
      width:34px;height:34px;border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      font-size:16px;
      opacity:.9;
    }

    /* HERO (NO animation, NO poster) */
    .hero{
      border-radius: var(--r24);
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .hero::after{
      content:"";
      position:absolute; inset:0;
      background: radial-gradient(1000px 520px at 70% 50%, rgba(255,255,255,.05), transparent 60%);
      pointer-events:none;
    }
    .hero-inner{
      position:relative;
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:18px;
      padding:22px;
      min-height: 360px;
    }
    @media (max-width: 900px){ .hero-inner{grid-template-columns:1fr; min-height:unset} }

    .hero-left{display:flex; flex-direction:column; gap:12px; padding:10px 6px; max-width: 560px;}
    .hero-h1{font-size:34px;font-weight:980;letter-spacing:.2px;margin:0;line-height:1.12;}
    .hero-sub{color: rgba(233,237,246,.85);font-size:14px;margin-top:-4px;}

    .meta-row{display:flex; gap:10px; flex-wrap:wrap; margin-top:6px;}
    .tag{
      display:inline-flex; align-items:center; justify-content:center;
      padding:6px 10px;
      border-radius: 10px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.20);
      font-weight:900;
      font-size:12px;
      color: rgba(233,237,246,.92);
    }
    .tag.imdb{border-color: rgba(241,197,90,.35); box-shadow: 0 0 0 3px rgba(241,197,90,.08) inset;}
    .hero-desc{margin:6px 0 0;color: rgba(233,237,246,.84);line-height:1.55;font-size:14px;max-width: 560px;}

    .hero-actions{display:flex; gap:12px; flex-wrap:wrap; margin-top:8px; align-items:center;}
    .btn-play{
      display:inline-flex; align-items:center; justify-content:center; gap:10px;
      height:48px; padding:0 18px;
      border-radius: 999px;
      border:1px solid rgba(241,197,90,.35);
      background: linear-gradient(180deg, rgba(241,197,90,.95), rgba(241,197,90,.72));
      color:#14161f;
      font-weight:980;
      cursor:pointer;
      box-shadow: 0 16px 40px rgba(241,197,90,.16);
    }
    .btn-ghost{
      display:inline-flex; align-items:center; justify-content:center;
      height:44px; width:44px;
      border-radius: 999px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      cursor:pointer;
      font-weight:950;
      color: rgba(233,237,246,.92);
      user-select:none;
    }
    .btn-ghost:hover{background: rgba(255,255,255,.10);}

    /* Right side: khung placeholder tƒ©nh */
    .hero-right{display:flex; align-items:flex-end; justify-content:flex-end; padding:10px 6px;}
    .preview-box{
      width:min(420px, 100%);
      border-radius: var(--r20);
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .preview-media{
      aspect-ratio: 16/9;
      background: rgba(255,255,255,.05);
      border-bottom:1px solid rgba(255,255,255,.10);
      display:flex; align-items:center; justify-content:center;
      color: rgba(233,237,246,.78);
      font-weight:950;
      letter-spacing:.2px;
    }
    .preview-info{padding:12px 12px 14px; display:flex; flex-direction:column; gap:8px;}
    .line{height:10px; border-radius:999px; background: rgba(255,255,255,.08);}
    .line.w60{width:60%}
    .line.w80{width:80%}
    .line.w40{width:40%}

    /* CAROUSEL */
    .carousel{
      margin-top:14px;
      border-radius: var(--r24);
      border:1px solid rgba(255,255,255,.10);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      box-shadow: var(--shadow2);
      overflow:hidden;
    }
    .carousel-inner{padding:14px 14px 16px;}
    .strip{display:flex; gap:10px; overflow:auto; padding-bottom: 4px; scroll-snap-type: x mandatory;}
    .strip::-webkit-scrollbar{height:10px}
    .strip::-webkit-scrollbar-thumb{background: rgba(255,255,255,.10); border-radius:999px;}

    .thumb{
      scroll-snap-align:start;
      width:92px; flex: 0 0 92px;
      aspect-ratio: 2/3;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.12);
      background:
        radial-gradient(60px 60px at 30% 20%, rgba(241,197,90,.10), transparent 65%),
        radial-gradient(60px 60px at 70% 30%, rgba(96,165,250,.10), transparent 65%),
        rgba(0,0,0,.22);
      box-shadow: 0 10px 24px rgba(0,0,0,.30);
      position:relative;
      overflow:hidden;
      cursor:pointer;
      user-select:none;
      transition: .12s ease;
    }
    .thumb:hover{border-color: rgba(255,255,255,.20); transform: translateY(-2px);}
    .thumb.active{
      border-color: rgba(241,197,90,.45);
      box-shadow: 0 0 0 4px rgba(241,197,90,.10) inset, 0 10px 24px rgba(0,0,0,.30);
    }
    .thumb .tlabel{
      position:absolute; left:8px; right:8px; bottom:8px;
      padding:8px 8px;
      border-radius: 12px;
      background: rgba(0,0,0,.45);
      border:1px solid rgba(255,255,255,.12);
      font-weight:950;
      font-size:11px;
      line-height:1.2;
      color: rgba(233,237,246,.95);
      display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;
    }
    .thumb .fav{
      position:absolute; right:8px; top:8px;
      width:26px;height:26px;border-radius:999px;
      display:flex;align-items:center;justify-content:center;
      background: rgba(0,0,0,.35);
      border:1px solid rgba(255,255,255,.12);
      font-size:14px;
      opacity:.95;
    }

    /* Modal */
    .modal-backdrop{
      position:fixed; inset:0;
      background: rgba(0,0,0,.60);
      display:none;
      align-items:center;
      justify-content:center;
      padding:16px;
      z-index:100;
    }
    .modal-backdrop.open{display:flex;}
    .modal{
      width:min(760px, 100%);
      border-radius: 20px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(10,11,16,.92);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modal-head{
      display:flex; align-items:center; justify-content:space-between;
      padding:14px 16px;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .modal-title{font-weight:980}
    .modal-body{padding:14px 16px; color: rgba(233,237,246,.88); line-height:1.55;}
    .modal-close{
      border:none;
      background: rgba(255,255,255,.06);
      color: var(--text);
      width:38px;height:38px;border-radius:999px;
      cursor:pointer;
      border:1px solid rgba(255,255,255,.12);
      font-weight:950;
    }

    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      background: rgba(10,11,16,.92);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 999px;
      padding:10px 14px;
      box-shadow: var(--shadow2);
      color: rgba(233,237,246,.92);
      font-weight:900;
      font-size:13px;
      display:none;
      z-index:120;
    }
    .toast.show{display:block;}
  </style>
</head>

<body>
  <!-- TOPBAR -->
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand" id="homeBtn" title="V·ªÅ trang ch·ªß">
        <div class="logo"></div>
        <div>
          <div class="t1">PhimApp</div>
          <div class="t2">Khung s∆∞·ªùn UI ‚Ä¢ kh√¥ng ·∫£nh/kh√¥ng animation</div>
        </div>
      </div>

      <div class="search">
        <div>üîé</div>
        <input id="searchInput" placeholder="T√¨m ki·∫øm phim, di·ªÖn vi√™n..." />
      </div>

      <div class="menu">
        <div class="dropdown">
          <div class="mitem" id="btnGenre">Th·ªÉ lo·∫°i ‚ñæ</div>
          <div class="dd-panel" id="ddGenre"></div>
        </div>
        <div class="mitem" id="btnMovie">Phim L·∫ª</div>
        <div class="mitem" id="btnSeries">Phim B·ªô</div>
        <div class="dropdown">
          <div class="mitem" id="btnCountry">Qu·ªëc gia ‚ñæ</div>
          <div class="dd-panel" id="ddCountry"></div>
        </div>
      </div>

      <div class="member" id="memberBtn" title="M·ªü trang Admin">
        <span class="dot"></span>
        <span>Th√†nh vi√™n</span>
      </div>
    </div>
  </div>

  <div class="wrap">
    <div class="section-title">
      Kho T√†ng Anime M·ªõi Nh·∫•t
      <span class="pill">‚Ä∫</span>
    </div>

    <!-- HERO -->
    <section class="hero">
      <div class="hero-inner">
        <div class="hero-left">
          <h1 class="hero-h1" id="heroTitle">T√™n Anime / Phim (Placeholder)</h1>
          <div class="hero-sub" id="heroSub">T√™n ph·ª• / English title (placeholder)</div>

          <div class="meta-row" id="heroMetaTop"></div>
          <div class="meta-row" id="heroMetaTags" style="margin-top:2px"></div>

          <p class="hero-desc" id="heroDesc">
            ƒê√¢y l√† m√¥ t·∫£ n·ªôi dung (placeholder).
          </p>

          <div class="hero-actions">
            <button class="btn-play" id="playBtn">‚ñ∂ Xem ngay</button>
            <button class="btn-ghost" id="favBtn" title="Y√™u th√≠ch">‚ô°</button>
            <button class="btn-ghost" id="infoBtn" title="Th√¥ng tin">i</button>
          </div>
        </div>

        <div class="hero-right">
          <div class="preview-box">
            <div class="preview-media">PREVIEW (placeholder)</div>
            <div class="preview-info">
              <div class="line w80"></div>
              <div class="line w60"></div>
              <div class="line w40"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- CAROUSEL -->
    <section class="carousel">
      <div class="carousel-inner">
        <div class="strip" id="strip"></div>
      </div>
    </section>
  </div>

  <!-- MODAL -->
  <div class="modal-backdrop" id="modalBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <div class="modal-head">
        <div class="modal-title" id="modalTitle">Th√¥ng tin</div>
        <button class="modal-close" id="modalClose" aria-label="Close">‚úï</button>
      </div>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>

  <div class="toast" id="toast">Saved</div>

  <script>
    // ========== DATA (placeholder) ==========
    // B·∫°n c√≥ th·ªÉ thay b·∫±ng data t·ª´ localStorage/Supabase sau.
    const DATA = [
      { id:"aono2", type:"series", title:"Ao no Orchestra 2nd Season", sub:"Blue Orchestra Season 2", imdb:"6.8", quality:"FHD", year:"2025", part:"Ph·∫ßn 2", ep:"T·∫≠p 18",
        tags:["Ch√≠nh K·ªãch","Ho·∫°t H√¨nh","T√¨nh C·∫£m","T√¢m L√Ω"], genre:"Ho·∫°t H√¨nh", country:"JP",
        desc:"V√†o m√πa thu nƒÉm cu·ªëi c·∫•p trung h·ªçc c∆° s·ªü... (placeholder m√¥ t·∫£)"},
      { id:"dandadan", type:"series", title:"Dandadan", sub:"Dandadan (TV)", imdb:"8.1", quality:"FHD", year:"2024", part:"Ph·∫ßn 1", ep:"T·∫≠p 12",
        tags:["H√†i","Si√™u Nhi√™n","H√†nh ƒê·ªông"], genre:"Si√™u Nhi√™n", country:"JP",
        desc:"M·ªôt c·∫∑p ƒë√¥i k·ª≥ l·∫° lao v√†o nh·ªØng v·ª• vi·ªác..."},
      { id:"solo", type:"series", title:"Solo Leveling", sub:"Ore dake Level Up na Ken", imdb:"8.3", quality:"FHD", year:"2024", part:"Ph·∫ßn 1", ep:"T·∫≠p 12",
        tags:["H√†nh ƒê·ªông","Fantasy"], genre:"Fantasy", country:"KR",
        desc:"Th·∫ø gi·ªõi n∆°i th·ª£ sƒÉn sƒÉn qu√°i..."},
      { id:"movie1", type:"movie", title:"The Demo Movie", sub:"Demo Movie 2026", imdb:"7.0", quality:"4K", year:"2026", part:"", ep:"",
        tags:["H√†nh ƒê·ªông","Phi√™u L∆∞u"], genre:"H√†nh ƒê·ªông", country:"US",
        desc:"Phim demo ƒë·ªÉ test UI."},
      { id:"anime1", type:"series", title:"Anime Placeholder", sub:"Anime Sub Title", imdb:"7.6", quality:"HD", year:"2023", part:"Ph·∫ßn 1", ep:"T·∫≠p 24",
        tags:["Phi√™u L∆∞u","Fantasy"], genre:"Fantasy", country:"VN",
        desc:"M√¥ t·∫£ placeholder‚Ä¶"}
    ];

    const LS_FAV = "phimapp_favs_v1";

    // ========== STATE ==========
    const state = {
      q: "",
      type: "all",       // all | movie | series
      genre: "",
      country: "",
      activeId: DATA[0]?.id ?? "",
      favs: new Set(),
    };

    // ========== DOM ==========
    const el = {
      searchInput: document.getElementById("searchInput"),
      strip: document.getElementById("strip"),

      heroTitle: document.getElementById("heroTitle"),
      heroSub: document.getElementById("heroSub"),
      heroMetaTop: document.getElementById("heroMetaTop"),
      heroMetaTags: document.getElementById("heroMetaTags"),
      heroDesc: document.getElementById("heroDesc"),

      playBtn: document.getElementById("playBtn"),
      favBtn: document.getElementById("favBtn"),
      infoBtn: document.getElementById("infoBtn"),

      btnGenre: document.getElementById("btnGenre"),
      ddGenre: document.getElementById("ddGenre"),
      btnCountry: document.getElementById("btnCountry"),
      ddCountry: document.getElementById("ddCountry"),

      btnMovie: document.getElementById("btnMovie"),
      btnSeries: document.getElementById("btnSeries"),

      memberBtn: document.getElementById("memberBtn"),
      homeBtn: document.getElementById("homeBtn"),

      modalBackdrop: document.getElementById("modalBackdrop"),
      modalClose: document.getElementById("modalClose"),
      modalTitle: document.getElementById("modalTitle"),
      modalBody: document.getElementById("modalBody"),

      toast: document.getElementById("toast"),
    };

    // ========== HELPERS ==========
    function escapeHtml(s){
      return String(s ?? "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#39;");
    }

    function toast(msg){
      el.toast.textContent = msg;
      el.toast.classList.add("show");
      clearTimeout(toast._t);
      toast._t = setTimeout(()=> el.toast.classList.remove("show"), 1200);
    }

    function loadFavs(){
      try{
        const raw = localStorage.getItem(LS_FAV);
        const arr = JSON.parse(raw || "[]");
        state.favs = new Set(Array.isArray(arr) ? arr : []);
      }catch{
        state.favs = new Set();
      }
    }

    function saveFavs(){
      localStorage.setItem(LS_FAV, JSON.stringify([...state.favs]));
    }

    function getActive(){
      return DATA.find(x=>x.id === state.activeId) || DATA[0];
    }

    function unique(list){
      const s = new Set();
      list.forEach(v=>{ if(String(v||"").trim()) s.add(String(v).trim()); });
      return [...s].sort((a,b)=>a.localeCompare(b));
    }

    // ========== FILTERING ==========
    function filteredItems(){
      const q = state.q.trim().toLowerCase();
      return DATA.filter(x=>{
        if(state.type !== "all" && x.type !== state.type) return false;
        if(state.genre && x.genre !== state.genre) return false;
        if(state.country && x.country !== state.country) return false;

        if(q){
          const hay = `${x.title} ${x.sub} ${x.year} ${x.genre} ${x.country} ${(x.tags||[]).join(" ")}`.toLowerCase();
          if(!hay.includes(q)) return false;
        }
        return true;
      });
    }

    // ========== RENDER ==========
    function renderHero(){
      const x = getActive();
      if(!x) return;

      el.heroTitle.textContent = x.title || "‚Äî";
      el.heroSub.textContent = x.sub || "";

      // meta top row
      const top = [];
      if(x.imdb) top.push(`<span class="tag imdb">IMDb ${escapeHtml(x.imdb)}</span>`);
      if(x.quality) top.push(`<span class="tag">${escapeHtml(x.quality)}</span>`);
      if(x.year) top.push(`<span class="tag">${escapeHtml(x.year)}</span>`);
      if(x.part) top.push(`<span class="tag">${escapeHtml(x.part)}</span>`);
      if(x.ep) top.push(`<span class="tag">${escapeHtml(x.ep)}</span>`);
      el.heroMetaTop.innerHTML = top.join("");

      // tag row
      el.heroMetaTags.innerHTML = (x.tags || []).map(t=>`<span class="tag">${escapeHtml(t)}</span>`).join("");

      el.heroDesc.textContent = x.desc || "";

      // fav button
      el.favBtn.textContent = state.favs.has(x.id) ? "‚ô•" : "‚ô°";
      el.favBtn.title = state.favs.has(x.id) ? "B·ªè y√™u th√≠ch" : "Y√™u th√≠ch";
    }

    function renderStrip(){
      const items = filteredItems();

      // ensure active is visible; if active filtered out, switch to first item
      if(items.length && !items.some(i=>i.id===state.activeId)){
        state.activeId = items[0].id;
      }

      el.strip.innerHTML = items.map(x=>{
        const isActive = x.id===state.activeId;
        const isFav = state.favs.has(x.id);
        return `
          <div class="thumb ${isActive ? "active":""}" data-id="${escapeHtml(x.id)}" title="${escapeHtml(x.title)}">
            <div class="fav" title="Y√™u th√≠ch">${isFav ? "‚ô•" : "‚ô°"}</div>
            <div class="tlabel">${escapeHtml(x.title)}</div>
          </div>
        `;
      }).join("");

      // bind click
      [...el.strip.querySelectorAll(".thumb")].forEach(card=>{
        card.addEventListener("click", (e)=>{
          const id = card.getAttribute("data-id");
          if(!id) return;
          state.activeId = id;
          renderHero();
          renderStrip();
        });
      });
    }

    function renderDropdowns(){
      const genres = unique(DATA.map(x=>x.genre));
      const countries = unique(DATA.map(x=>x.country));

      el.ddGenre.innerHTML = [
        `<div class="dd-item" data-v=""><span>T·∫•t c·∫£</span><small>${genres.length}</small></div>`,
        ...genres.map(g=>`<div class="dd-item" data-v="${escapeHtml(g)}"><span>${escapeHtml(g)}</span></div>`)
      ].join("");

      el.ddCountry.innerHTML = [
        `<div class="dd-item" data-v=""><span>T·∫•t c·∫£</span><small>${countries.length}</small></div>`,
        ...countries.map(c=>`<div class="dd-item" data-v="${escapeHtml(c)}"><span>${escapeHtml(c)}</span></div>`)
      ].join("");

      // click handlers
      [...el.ddGenre.querySelectorAll(".dd-item")].forEach(it=>{
        it.addEventListener("click", ()=>{
          state.genre = it.getAttribute("data-v") || "";
          closeDropdowns();
          toast(state.genre ? `Genre: ${state.genre}` : "Genre: T·∫•t c·∫£");
          renderStrip();
          renderHero();
          syncMenuActive();
        });
      });

      [...el.ddCountry.querySelectorAll(".dd-item")].forEach(it=>{
        it.addEventListener("click", ()=>{
          state.country = it.getAttribute("data-v") || "";
          closeDropdowns();
          toast(state.country ? `Country: ${state.country}` : "Country: T·∫•t c·∫£");
          renderStrip();
          renderHero();
          syncMenuActive();
        });
      });
    }

    function syncMenuActive(){
      // type buttons
      el.btnMovie.classList.toggle("active", state.type==="movie");
      el.btnSeries.classList.toggle("active", state.type==="series");

      // dropdown buttons: active if filter selected
      el.btnGenre.classList.toggle("active", !!state.genre);
      el.btnCountry.classList.toggle("active", !!state.country);

      // show filter state in button text
      el.btnGenre.textContent = state.genre ? `Th·ªÉ lo·∫°i: ${state.genre} ‚ñæ` : "Th·ªÉ lo·∫°i ‚ñæ";
      el.btnCountry.textContent = state.country ? `Qu·ªëc gia: ${state.country} ‚ñæ` : "Qu·ªëc gia ‚ñæ";
    }

    // ========== DROPDOWN CONTROL ==========
    function closeDropdowns(){
      el.ddGenre.classList.remove("open");
      el.ddCountry.classList.remove("open");
    }
    function toggleDropdown(which){
      if(which==="genre"){
        const open = el.ddGenre.classList.toggle("open");
        el.ddCountry.classList.remove("open");
        return open;
      }
      if(which==="country"){
        const open = el.ddCountry.classList.toggle("open");
        el.ddGenre.classList.remove("open");
        return open;
      }
      return false;
    }

    // ========== MODAL ==========
    function openModal(title, html){
      el.modalTitle.textContent = title;
      el.modalBody.innerHTML = html;
      el.modalBackdrop.classList.add("open");
      el.modalBackdrop.setAttribute("aria-hidden","false");
    }
    function closeModal(){
      el.modalBackdrop.classList.remove("open");
      el.modalBackdrop.setAttribute("aria-hidden","true");
    }

    // ========== EVENTS ==========
    function bind(){
      // search
      el.searchInput.addEventListener("input", ()=>{
        state.q = el.searchInput.value;
        renderStrip();
        renderHero();
      });

      // menu dropdown toggles
      el.btnGenre.addEventListener("click", (e)=>{ e.stopPropagation(); toggleDropdown("genre"); });
      el.btnCountry.addEventListener("click", (e)=>{ e.stopPropagation(); toggleDropdown("country"); });

      // type filter
      el.btnMovie.addEventListener("click", ()=>{
        state.type = (state.type==="movie") ? "all" : "movie";
        toast(state.type==="movie" ? "Filter: Movie" : "Filter: All");
        renderStrip(); renderHero(); syncMenuActive();
      });
      el.btnSeries.addEventListener("click", ()=>{
        state.type = (state.type==="series") ? "all" : "series";
        toast(state.type==="series" ? "Filter: Series" : "Filter: All");
        renderStrip(); renderHero(); syncMenuActive();
      });

      // click outside to close dropdown
      document.addEventListener("click", ()=> closeDropdowns());

      // play button
      el.playBtn.addEventListener("click", ()=>{
        const x = getActive();
        if(!x) return;
        // chuy·ªÉn sang watch.html. B·∫°n c√≥ th·ªÉ ƒë·ªïi sang link th·∫≠t: x.url
        location.href = `watch.html?url=${encodeURIComponent(x.id)}`;
      });

      // fav button
      el.favBtn.addEventListener("click", ()=>{
        const x = getActive();
        if(!x) return;
        if(state.favs.has(x.id)){
          state.favs.delete(x.id);
          toast("ƒê√£ b·ªè y√™u th√≠ch");
        }else{
          state.favs.add(x.id);
          toast("ƒê√£ th√™m y√™u th√≠ch");
        }
        saveFavs();
        renderHero();
        renderStrip();
      });

      // info button
      el.infoBtn.addEventListener("click", ()=>{
        const x = getActive();
        if(!x) return;
        const html = `
          <div style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:10px">
            ${x.imdb ? `<span class="tag imdb">IMDb ${escapeHtml(x.imdb)}</span>`:""}
            ${x.quality ? `<span class="tag">${escapeHtml(x.quality)}</span>`:""}
            ${x.year ? `<span class="tag">${escapeHtml(x.year)}</span>`:""}
            ${x.genre ? `<span class="tag">${escapeHtml(x.genre)}</span>`:""}
            ${x.country ? `<span class="tag">${escapeHtml(x.country)}</span>`:""}
            <span class="tag">${escapeHtml(x.type)}</span>
          </div>
          <div style="color:rgba(233, hookup)"></div>
          <div><b>M√¥ t·∫£:</b><br>${escapeHtml(x.desc || "‚Äî")}</div>
          <div style="margin-top:10px;color:rgba(233,237,246,.78)">
            <b>ID:</b> ${escapeHtml(x.id)}
          </div>
        `.replace("hookup","237,246,.88"); // tr√°nh highlight t·ª± ƒë·ªông
        openModal(x.title || "Th√¥ng tin", html);
      });

      // modal close
      el.modalClose.addEventListener("click", closeModal);
      el.modalBackdrop.addEventListener("click", (e)=>{ if(e.target===el.modalBackdrop) closeModal(); });
      document.addEventListener("keydown", (e)=>{ if(e.key==="Escape") closeModal(); });

      // member -> m·ªü admin
      el.memberBtn.addEventListener("click", ()=>{
        location.href = "test.html";
      });

      // brand -> reset filters
      el.homeBtn.addEventListener("click", ()=>{
        state.q=""; state.type="all"; state.genre=""; state.country="";
        el.searchInput.value="";
        toast("Reset filters");
        renderStrip(); renderHero(); syncMenuActive();
      });
    }

    // ========== INIT ==========
    (function init(){
      loadFavs();
      renderDropdowns();
      syncMenuActive();
      bind();
      renderStrip();
      renderHero();
    })();
  </script>
</body>
</html>
